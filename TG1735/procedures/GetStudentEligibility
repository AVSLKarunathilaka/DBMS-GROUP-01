CREATE PROCEDURE GetStudentEligibility(IN p_registration_number VARCHAR(15))
BEGIN
    SELECT 
        e.registration_no, 
        e.course_code, 
        c.name AS course_name,
        COALESCE(e.eligibility_status, 'Unknown') AS eligibility_status
    FROM EligibleStudentsView e
    JOIN Course c ON e.course_code = c.course_code
    WHERE e.registration_no = p_registration_number
    ORDER BY e.course_code;
END;
//

DELIMITER ;